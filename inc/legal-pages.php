<?php
/**
 * Создание юридических страниц
 *
 * Создаёт страницы: Политика конфиденциальности, Пользовательское соглашение,
 * Обработка персональных данных, Политика cookies
 *
 * @package Gociss
 */

if ( ! defined( 'ABSPATH' ) ) {
	exit;
}

/**
 * Создаёт юридические страницы при активации темы
 */
function gociss_create_legal_pages() {
	$legal_pages = gociss_get_legal_pages_content();

	foreach ( $legal_pages as $slug => $page_data ) {
		// Проверяем, существует ли страница
		$existing_page = get_page_by_path( $slug );
		if ( $existing_page ) {
			continue;
		}

		// Создаём страницу
		$page_id = wp_insert_post(
			array(
				'post_title'   => $page_data['title'],
				'post_name'    => $slug,
				'post_content' => $page_data['content'],
				'post_status'  => 'publish',
				'post_type'    => 'page',
				'post_author'  => 1,
			)
		);

		// Устанавливаем шаблон страницы
		if ( $page_id && ! is_wp_error( $page_id ) ) {
			update_post_meta( $page_id, '_wp_page_template', 'page-legal.php' );
		}
	}
}
add_action( 'after_switch_theme', 'gociss_create_legal_pages' );

/**
 * Возвращает контент для юридических страниц
 *
 * @return array Массив страниц с контентом
 */
function gociss_get_legal_pages_content() {
	$company_name = 'ООО "ГОЦИСС"';
	$site_url     = home_url();
	$email        = 'info@gociss.ru';
	$phone        = '+7 (800) 551-02-36';
	$address      = '197110, г. Санкт-Петербург, ул. Парковая, 4, лит Д, оф 255';

	return array(
		'privacy-policy' => array(
			'title'   => 'Политика конфиденциальности',
			'content' => gociss_get_privacy_policy_content( $company_name, $site_url, $email, $address ),
		),
		'terms'          => array(
			'title'   => 'Пользовательское соглашение',
			'content' => gociss_get_terms_content( $company_name, $site_url, $email ),
		),
		'personal-data'  => array(
			'title'   => 'Обработка персональных данных',
			'content' => gociss_get_personal_data_content( $company_name, $email, $address ),
		),
		'cookie-policy'  => array(
			'title'   => 'Политика использования cookies',
			'content' => gociss_get_cookie_policy_content( $company_name, $site_url ),
		),
	);
}

/**
 * Контент политики конфиденциальности
 */
function gociss_get_privacy_policy_content( $company_name, $site_url, $email, $address ) {
	return <<<HTML
<h2>1. Общие положения</h2>
<p>Настоящая Политика конфиденциальности персональных данных (далее – Политика) действует в отношении всей информации, которую {$company_name} (далее – Оператор), расположенный на доменном имени {$site_url}, может получить о Пользователе во время использования сайта, программ и продуктов Оператора.</p>

<h2>2. Определения терминов</h2>
<p>2.1. В настоящей Политике используются следующие термины:</p>
<ul>
<li><strong>«Персональные данные»</strong> — любая информация, относящаяся к прямо или косвенно определённому или определяемому физическому лицу (субъекту персональных данных).</li>
<li><strong>«Обработка персональных данных»</strong> — любое действие (операция) или совокупность действий (операций) с персональными данными, включая сбор, запись, систематизацию, накопление, хранение, уточнение (обновление, изменение), извлечение, использование, передачу (распространение, предоставление, доступ), обезличивание, блокирование, удаление, уничтожение персональных данных.</li>
<li><strong>«Оператор»</strong> — {$company_name}, самостоятельно организующее и (или) осуществляющее обработку персональных данных.</li>
<li><strong>«Пользователь»</strong> — посетитель сайта {$site_url}.</li>
</ul>

<h2>3. Персональные данные Пользователей</h2>
<p>3.1. Оператор может обрабатывать следующие персональные данные Пользователя:</p>
<ul>
<li>Фамилия, имя, отчество</li>
<li>Электронный адрес (e-mail)</li>
<li>Номера телефонов</li>
<li>Название организации</li>
<li>Должность</li>
<li>Иные данные, добровольно предоставленные Пользователем</li>
</ul>

<p>3.2. Также на сайте происходит сбор и обработка обезличенных данных о посетителях (в т.ч. файлов «cookie») с помощью сервисов интернет-статистики (Яндекс Метрика, Google Analytics и других).</p>

<h2>4. Цели обработки персональных данных</h2>
<p>4.1. Персональные данные Пользователя Оператор может использовать в следующих целях:</p>
<ul>
<li>Идентификация Пользователя для оформления заявки на услуги</li>
<li>Предоставление Пользователю информации об услугах</li>
<li>Обратная связь с Пользователем</li>
<li>Уведомление Пользователя о новостях, акциях и специальных предложениях</li>
<li>Проведение статистических и иных исследований</li>
</ul>

<h2>5. Правовые основания обработки персональных данных</h2>
<p>5.1. Оператор обрабатывает персональные данные Пользователя только в случае их отправки Пользователем через формы, расположенные на сайте {$site_url}. Отправляя свои персональные данные Оператору, Пользователь выражает своё согласие с данной Политикой.</p>

<h2>6. Порядок сбора, хранения и защиты персональных данных</h2>
<p>6.1. Оператор обеспечивает сохранность персональных данных и принимает все возможные меры, исключающие доступ к персональным данным неуполномоченных лиц.</p>
<p>6.2. Персональные данные Пользователя никогда, ни при каких условиях не будут переданы третьим лицам, за исключением случаев, связанных с исполнением действующего законодательства.</p>

<h2>7. Права Пользователя</h2>
<p>7.1. Пользователь вправе:</p>
<ul>
<li>Получить информацию, касающуюся обработки его персональных данных</li>
<li>Требовать уточнения, блокирования или уничтожения персональных данных</li>
<li>Отозвать согласие на обработку персональных данных</li>
</ul>

<h2>8. Контактная информация</h2>
<p>По всем вопросам, связанным с обработкой персональных данных, Вы можете обратиться:</p>
<ul>
<li>Email: {$email}</li>
<li>Адрес: {$address}</li>
</ul>
HTML;
}

/**
 * Контент пользовательского соглашения
 */
function gociss_get_terms_content( $company_name, $site_url, $email ) {
	return <<<HTML
<h2>1. Общие положения</h2>
<p>1.1. Настоящее Пользовательское соглашение (далее — Соглашение) относится к сайту {$site_url}, расположенному по адресу {$site_url}.</p>
<p>1.2. Сайт {$site_url} является собственностью {$company_name}.</p>
<p>1.3. Настоящее Соглашение регулирует отношения между Администрацией сайта (далее — Администрация) и Пользователем данного сайта.</p>

<h2>2. Предмет соглашения</h2>
<p>2.1. Предметом настоящего Соглашения является предоставление Пользователю доступа к содержащимся на сайте услугам и информации.</p>
<p>2.2. Использование материалов и сервисов сайта регулируется нормами действующего законодательства Российской Федерации.</p>

<h2>3. Права и обязанности сторон</h2>

<h3>3.1. Администрация сайта вправе:</h3>
<ul>
<li>Изменять правила пользования сайтом, а также изменять содержание данного сайта</li>
<li>Ограничить доступ к сайту в случае нарушения Пользователем условий настоящего Соглашения</li>
</ul>

<h3>3.2. Пользователь вправе:</h3>
<ul>
<li>Получить доступ к использованию сайта</li>
<li>Пользоваться всеми имеющимися на сайте услугами</li>
<li>Задавать любые вопросы, относящиеся к услугам сайта</li>
<li>Пользоваться сайтом исключительно в целях, не запрещённых законодательством РФ</li>
</ul>

<h3>3.3. Пользователь обязуется:</h3>
<ul>
<li>Предоставлять достоверную информацию при заполнении форм на сайте</li>
<li>Не предпринимать действий, которые могут нарушить нормальную работу сайта</li>
<li>Не распространять с использованием сайта любую информацию, нарушающую законодательство РФ</li>
</ul>

<h2>4. Ответственность сторон</h2>
<p>4.1. Администрация не несёт ответственности за временную неработоспособность сайта, которая может возникнуть в результате технических работ или по причинам, не зависящим от Администрации.</p>
<p>4.2. Администрация не несёт ответственности за любые виды убытков, произошедших вследствие использования Пользователем услуг сайта или материалов сайта.</p>

<h2>5. Информационный характер материалов</h2>
<p><strong>Материалы, размещенные на сайте, носят информационный характер и ни при каких условиях не являются публичной офертой, определяемой положениями ст. 437 Гражданского кодекса РФ.</strong></p>

<h2>6. Разрешение споров</h2>
<p>6.1. В случае возникновения споров стороны будут стремиться урегулировать их путём переговоров.</p>
<p>6.2. При невозможности достижения согласия споры разрешаются в судебном порядке в соответствии с действующим законодательством РФ.</p>

<h2>7. Дополнительные условия</h2>
<p>7.1. Администрация вправе вносить изменения в настоящее Соглашение без согласия Пользователя.</p>
<p>7.2. Новая редакция Соглашения вступает в силу с момента её размещения на сайте.</p>
<p>7.3. Продолжая использовать сайт после изменения Соглашения, Пользователь выражает согласие с внесёнными изменениями.</p>

<h2>8. Контактная информация</h2>
<p>По всем вопросам обращайтесь по адресу: {$email}</p>
HTML;
}

/**
 * Контент страницы обработки персональных данных
 */
function gociss_get_personal_data_content( $company_name, $email, $address ) {
	return <<<HTML
<h2>Согласие на обработку персональных данных</h2>
<p>Настоящим я, субъект персональных данных, свободно, своей волей и в своём интересе даю согласие {$company_name} (далее — Оператор) на обработку моих персональных данных на следующих условиях:</p>

<h2>1. Перечень персональных данных</h2>
<p>Согласие даётся на обработку следующих персональных данных:</p>
<ul>
<li>Фамилия, имя, отчество</li>
<li>Номер телефона</li>
<li>Адрес электронной почты (e-mail)</li>
<li>Наименование организации</li>
<li>Должность</li>
<li>Иные данные, добровольно сообщённые мной</li>
</ul>

<h2>2. Цель обработки персональных данных</h2>
<p>Персональные данные обрабатываются в следующих целях:</p>
<ul>
<li>Оказание консультационных услуг</li>
<li>Оформление заявок на сертификацию</li>
<li>Направление информационных материалов</li>
<li>Осуществление обратной связи</li>
<li>Ведение бухгалтерского учёта</li>
<li>Исполнение договорных обязательств</li>
</ul>

<h2>3. Способы обработки персональных данных</h2>
<p>Согласие даётся на совершение следующих действий (операций) с персональными данными:</p>
<ul>
<li>Сбор</li>
<li>Запись</li>
<li>Систематизация</li>
<li>Накопление</li>
<li>Хранение</li>
<li>Уточнение (обновление, изменение)</li>
<li>Извлечение</li>
<li>Использование</li>
<li>Передача (предоставление, доступ)</li>
<li>Обезличивание</li>
<li>Блокирование</li>
<li>Удаление</li>
<li>Уничтожение</li>
</ul>

<h2>4. Срок действия согласия</h2>
<p>Согласие действует с момента его предоставления до момента отзыва. Согласие может быть отозвано субъектом персональных данных путём направления письменного заявления Оператору.</p>

<h2>5. Сведения об Операторе</h2>
<ul>
<li><strong>Наименование:</strong> {$company_name}</li>
<li><strong>Адрес:</strong> {$address}</li>
<li><strong>Email:</strong> {$email}</li>
</ul>

<h2>6. Права субъекта персональных данных</h2>
<p>Субъект персональных данных имеет право:</p>
<ul>
<li>Требовать от Оператора уточнения персональных данных, их блокирования или уничтожения</li>
<li>Получить информацию, касающуюся обработки персональных данных</li>
<li>Обжаловать действия или бездействие Оператора в уполномоченный орган по защите прав субъектов персональных данных или в судебном порядке</li>
</ul>
HTML;
}

/**
 * Контент политики cookies
 */
function gociss_get_cookie_policy_content( $company_name, $site_url ) {
	return <<<HTML
<h2>Что такое файлы cookie?</h2>
<p>Файлы cookie — это небольшие текстовые файлы, которые сохраняются на вашем устройстве (компьютере, планшете или мобильном телефоне) при посещении веб-сайтов. Они позволяют сайту запоминать ваши действия и предпочтения в течение определённого времени.</p>

<h2>Какие файлы cookie мы используем?</h2>

<h3>Необходимые файлы cookie</h3>
<p>Эти файлы cookie необходимы для функционирования сайта и не могут быть отключены. Они обычно устанавливаются только в ответ на ваши действия, такие как настройка параметров конфиденциальности, вход в систему или заполнение форм.</p>

<h3>Аналитические файлы cookie</h3>
<p>Эти файлы cookie позволяют нам подсчитывать количество посещений и источники трафика, чтобы оценивать и улучшать работу сайта. Мы используем сервисы:</p>
<ul>
<li><strong>Яндекс.Метрика</strong> — для анализа поведения пользователей на сайте</li>
<li><strong>Google Analytics</strong> — для анализа статистики посещаемости</li>
</ul>

<h3>Функциональные файлы cookie</h3>
<p>Эти файлы cookie позволяют сайту запоминать сделанный вами выбор (например, ваш регион) и предоставлять улучшенные, персонализированные функции.</p>

<h2>Как управлять файлами cookie?</h2>
<p>Вы можете настроить свой браузер так, чтобы он блокировал или уведомлял вас о файлах cookie. Вот как это сделать в популярных браузерах:</p>
<ul>
<li><strong>Google Chrome:</strong> Настройки → Конфиденциальность и безопасность → Файлы cookie</li>
<li><strong>Mozilla Firefox:</strong> Настройки → Приватность и защита → Куки и данные сайтов</li>
<li><strong>Safari:</strong> Настройки → Конфиденциальность → Управление данными сайта</li>
<li><strong>Microsoft Edge:</strong> Настройки → Файлы cookie и разрешения сайтов</li>
</ul>

<h2>Влияние отключения файлов cookie</h2>
<p>Обратите внимание, что отключение некоторых файлов cookie может повлиять на функциональность сайта и качество предоставляемых услуг.</p>

<h2>Изменения в политике cookie</h2>
<p>Мы можем обновлять настоящую Политику использования файлов cookie. Все изменения будут опубликованы на данной странице с указанием даты последнего обновления.</p>

<h2>Контакты</h2>
<p>Если у вас есть вопросы относительно использования файлов cookie на нашем сайте, свяжитесь с нами через форму обратной связи или по контактным данным, указанным на сайте.</p>
HTML;
}


